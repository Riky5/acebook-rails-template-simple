<% @posts.each do |post| %>
  <p>User: <%= User.find(post.user_id).name + User.find(post.user_id).surname %></p>
  <%= content_tag :div, id: dom_id(post) do %>
      <p><%= post.message %></p>

    <% if post.image.attached? %>
      <p> <%= image_tag post.image%>
      </p>
    <% end %>
    
      <p>Posted on:<%= post.created_at %></p>
    <% pre_like = post.likes.find { |like| like.user_id == current_user.id} %>
    <% if pre_like %>
      <%= button_to 'Unlike', post_like_path(post, pre_like), method: :delete %>
    <% else %>
      <%= button_to 'Like', post_likes_path(post), method: :post %>
    <% end %>
      
      <p>
        <%= post.likes.count %> <%= post.likes.count == 1 ? 'Like' : 'Likes' %>
      </p>
  <% end %>
<% end %>

<div class="container is-fluid">
  <div class="columns">
    <div class="column"></div>
      <div id="new-post" class="column is-half">

        <div class="container p-4" id="post-section">
          <div id="avatar" class="p-5"></div>
            <div id="post-link" class="container is-fluid">
              <%= link_to new_post_path do %>
                <p id="text-link" class="mt-3 ml-2"> What's on your mind? </p>
              <% end %>
            </div>
        </div>

        <% @posts.each do |post| %>
        <div class="container p-5" id="post-container">
          <div class="container post-card p-4">
            <div class="container is-flex" id="post-details">
              <div id="avatar" class="p-5"></div>
              <div class="container is-fluid">
                <p id="user-name"><%= User.find(post.user_id).name %> <%= User.find(post.user_id).surname %></p>
                <p id="created-at"><%= post.created_at %></p>
              </div>
            </div>
            <div class="message-and-photo p-5">
              <p class="mb-2"><%= post.message %></p>
              <% if post.image.attached? %>
              <%= image_tag post.image%>
              <% end %>
            </div>
          </div>
          <div class="comments-section p-5">
            <p>Comments go here :D</p>
          </div>
        </div>   
        <% end %>

      </div>
    <div class="column"></div>
  </div>
</div>
